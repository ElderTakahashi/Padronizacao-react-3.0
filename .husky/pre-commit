

echo "ğŸ  Pre-commit starting..."

files=$(git diff --cached --diff-filter=ACMR --name-only)

if [ -z "$files" ]; then
  echo "âš ï¸  No staged files to lint or format. Skipping..."
  exit 0
fi

echo "ğŸ”  Running ESLint on staged files..."
if ! npx eslint --quiet $files; then
  echo "âŒ  ESLint found errors. Please fix them before committing."
  echo "ğŸ›‘  Commit aborted."
  exit 1
fi
echo "âœ…  ESLint passed."

echo "ğŸª„  Running Prettier check on staged files..."
if ! npx pretty-quick --staged --check --verbose; then
  echo "âŒ  Prettier found formatting issues. Please run 'npx prettier --write' to fix."
  echo "ğŸ›‘  Commit aborted."
  exit 1
fi
echo "âœ…  Prettier check passed."

# ProteÃ§Ã£o contra commits direto na main
branch="$(git rev-parse --abbrev-ref HEAD)"
# if [ "$branch" = "main" ]; then
#   echo -e "\nğŸ  You can't commit directly to the main branch!"
#   echo -e "\nâŒ  Pre-commit failed!\n"
#   exit 1
# fi

echo "âœ¨  Pre-commit checks passed! Proceeding with commit."
